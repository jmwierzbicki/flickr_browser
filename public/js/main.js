"use strict";function PhotoBrowserController(e,t,a){var n=this;n.search="",n.searchResults={},n.favList=[];var o=JSON.parse(localStorage.getItem("favList"));o instanceof Array&&(n.favList=o);var s={api_key:"d680468aa8d1d075113d8dbb102c5e6e",method:"flickr.photos.search",text:"",page:1,format:"json",nojsoncallback:1},r=function(e,t){var a="";return s.page=e,s.text=t,Object.keys(s).sort().forEach(function(e,t){a+=e+s[e]}),a},i=function(e,t){var a="https://api.flickr.com/services/rest/?";return s.page=e,s.text=t,Object.keys(s).sort().forEach(function(e,t){a+=e+"="+s[e]+"&"}),a},l=function(e,n){return a(function(a,o){t({method:"GET",url:"http://www.jmwierzbicki.hekko24.pl/getsignature/index.php?string="+r(e,n)}).then(function(e){a(e.data)},function(e){console.log(e)})})};n.searchPhotos=function(e,a){l(e,a).then(function(o){t({method:"GET",url:i(e,a)+"api_sig="+o}).then(function(e){n.searchResult=e.data.photos},function(e){console.log(e)})})},n.changePage=function(e){n.searchPhotos(e,n.search)},n.addToFav=function(e){console.log(e);for(var t=!1,a=0;a<n.favList.length;a++)if(n.favList[a].id==e.id){t=!0,alert("Ten obrazek jest już w ulubionych!!");break}t||(n.favList.push(e),localStorage.setItem("favList",JSON.stringify(n.favList)))},n.removeFromFav=function(e){n.favList.splice(e,1),localStorage.setItem("favList",JSON.stringify(n.favList))}}function FavListController(e){var t=this;t.removeFav=function(e){t.onRemove({index:e})}}function SearchListController(e){var t=this;t.searchResult={},t.changePage=function(e){t.onPage({page:e})},t.addFav=function(e){t.onAdd({image:e})},t.getImageThumbUrl=function(e){console.log(e)}}PhotoBrowserController.$inject=["$scope","$http","$q"],FavListController.$inject=["$scope"],SearchListController.$inject=["$scope"];var myApp=angular.module("myApp",["templates"]);angular.module("templates",[]),myApp.component("photoBrowser",{templateUrl:"photoBrowser/photoBrowser.html",controller:PhotoBrowserController,bindings:{}}),myApp.component("favList",{templateUrl:"photoBrowser/favList/favList.html",controller:FavListController,bindings:{favList:"<",onRemove:"&"}}),myApp.component("searchList",{templateUrl:"photoBrowser/searchList/searchList.html",controller:SearchListController,bindings:{searchResult:"<",onAdd:"&",onPage:"&"}}),angular.module("templates").run(["$templateCache",function(e){e.put("photoBrowser/photoBrowser.html",'<div>\n    <input class="form-control" placeholder="type text to search..." ng-model-options="{debounce: { \'default\': 500, \'blur\': 0 }}" ng-model="$ctrl.search" ng-change="$ctrl.searchPhotos(1, $ctrl.search)">\n    <div class="row" style="padding-top:20px;">\n        <div class="col-sm-2"><fav-list fav-list="$ctrl.favList" on-remove="$ctrl.removeFromFav(index)"></fav-list></div>\n        <div class="col-sm-9"><search-list search-result="$ctrl.searchResult" on-add="$ctrl.addToFav(image)" on-page="$ctrl.changePage(page)"></search-list></div>\n    </div>\n</div>\n'),e.put("photoBrowser/favList/favList.html",'<div>\n    ulubione:\n</div>\n<div style="position:relative;" ng-repeat="image in $ctrl.favList track by $index">\n    <a data-toggle="modal" data-target="#myModal{{$index}}">\n        <img style="width: 100%;"  ng-src="https://farm{{image.farm}}.staticflickr.com/{{image.server}}/{{image.id}}_{{image.secret}}_m.jpg">\n    </a>    <span class="glyphicon glyphicon-remove remove-button" ng-click="$ctrl.removeFav($index)"> </span>\n\n    <!-- Modal -->\n    <div class="modal fade" id="myModal{{$index}}" role="dialog">\n        <div class="modal-dialog modal-lg">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <button type="button" class="close" data-dismiss="modal">&times;</button>\n\n                </div>\n                <div class="modal-body" style="text-align: center;">\n                    id:{{image.id}}<br>\n                    title:{{image.title}}<br>\n                    <img style="max-width: 100%;"  ng-src="https://farm{{image.farm}}.staticflickr.com/{{image.server}}/{{image.id}}_{{image.secret}}_c.jpg">\n                </div>\n\n            </div>\n        </div>\n    </div>\n\n\n\n</div>\n'),e.put("photoBrowser/searchList/searchList.html",'<span ng-show="$ctrl.searchResult.total >= 0">liczba znalezionych obrazków:</span> {{$ctrl.searchResult.total}}\n<br>\n<div style="text-align: center;" ng-show="$ctrl.searchResult.pages > 1">\n    <span ng-show="$ctrl.searchResult.page > 1" class="glyphicon glyphicon-menu-left" ng-click="$ctrl.changePage($ctrl.searchResult.page-1)"> </span>\n    page: {{$ctrl.searchResult.page}}\n    <span  ng-show="$ctrl.searchResult.page < $ctrl.searchResult.pages" class="glyphicon glyphicon-menu-right" ng-click="$ctrl.changePage($ctrl.searchResult.page+1)"> </span>\n</div>\n\n\n<div>\n    <section id="photos">\n        <img ng-repeat="image in $ctrl.searchResult.photo" ng-click="$ctrl.addFav(image)" src="images/Placeholder.png" ng-src="https://farm{{image.farm}}.staticflickr.com/{{image.server}}/{{image.id}}_{{image.secret}}_m.jpg" >\n    </section>\n   </diV>\n')}]);